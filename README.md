EPL Match Outcome Prediction Project
This repository contains the code, datasets, and instructions for the project "Predicting English Premier League Match Outcomes Using Machine Learning, Temporal Convolutional Networks, and Graph Neural Networks." The project predicts EPL match outcomes (home team win, draw, or loss) using LightGBM, Temporal Convolutional Networks (TCN), and Graph Neural Networks (GNN), with data from 2010–2024.
Repository Contents

ML_EPL (1).ipynb: Jupyter Notebook with the complete code for data preprocessing, feature engineering, model implementation, and evaluation.
Premier_League.csv: Initial dataset with raw match data (e.g., teams, goals, attendance).
data_with_last_five_form.csv: Intermediate dataset with team form features (last 5 match points).
new_data_with_head_to_head_stats.csv: Dataset with head-to-head statistics scraped from the Sportmonks API.
updated_dataset.csv: Dataset with updated team IDs and cleaned features, used for final preprocessing steps.

Prerequisites

Python Version: Python 3.10
Hardware: A system with GPU support is recommended for TCN and GNN training (e.g., Google Colab with GPU runtime).
Sportmonks API Token: Required for scraping head-to-head stats. If you don’t have a token, use the provided new_data_with_head_to_head_stats.csv to skip this step.

Setup Instructions

Clone the Repository:
git clone https://github.com/amajety1/ML-Project-Final.git
cd ML-Project-Final


Install Dependencies:Create a virtual environment and install the required packages:
python -m venv venv
source venv/bin/activate  # On Windows: venv\Scripts\activate
pip install pandas numpy sklearn lightgbm torch torch-geometric requests matplotlib seaborn

For PyTorch Geometric, ensure compatibility with your PyTorch version. If using PyTorch 2.0.0 with CUDA 11.8:
pip install torch-scatter torch-sparse -f https://data.pyg.org/whl/torch-2.0.0+cu118.html
pip install torch-geometric


Prepare the Data:

The repository includes all necessary datasets. Place them in the same directory as ML_EPL (1).ipynb.
If you wish to re-scrape head-to-head stats:
Obtain a Sportmonks API token from Sportmonks.
Update the API_TOKEN variable in ML_EPL (1).ipynb:API_TOKEN = "Your_Sportmonks_API_Token"


Note: new_data_with_head_to_head_stats.csv already contains precomputed head-to-head stats, so scraping is optional.





Running the Experiments

Open the Notebook:Use Jupyter Notebook or Google Colab:
jupyter notebook "ML_EPL (1).ipynb"

Alternatively, upload ML_EPL (1).ipynb to Google Colab and enable GPU runtime.

Data Preprocessing:The notebook processes Premier_League.csv through several stages:

Cleaning: Drops post-match stats (e.g., shots, fouls) to prevent leakage.
Feature Engineering:
Team form (last 5 match points, saved in data_with_last_five_form.csv).
Head-to-head stats via Sportmonks API (saved in new_data_with_head_to_head_stats.csv).
Season-average possession, shots, passes, chances.
Rest days, day of week, time of day bins.


Encoding/Scaling: Encodes categorical variables (teams, stadiums) and scales numerical features.
The final dataset is saved as updated_dataset.csv and further processed into final_dataset_encoded.csv for modeling.


Model Training and Evaluation:The notebook implements three models:

LightGBM:
Run the LightGBM section to train and evaluate using GridSearchCV.
Output: Accuracy (~47%) and classification report.


Temporal Convolutional Network (TCN):
Requires PyTorch. Ensure GPU is enabled for faster training.
Trains for 20 epochs, reporting validation accuracy (~65%).


Graph Neural Network (GNN):
Requires PyTorch Geometric. Constructs a graph with teams as nodes and matches as edges.
Trains for 30 epochs, reporting accuracy (~70%, exact value depends on final logs).



To run all models, execute the notebook cells sequentially. Each model section prints accuracy and performance metrics.

Reproducing Results:

Use final_dataset_encoded.csv (generated by the notebook) for model training to skip preprocessing.
Expected outputs:
LightGBM: ~47% accuracy.
TCN: ~65% accuracy.
GNN: Highest accuracy (~70%, pending final logs).


Results may vary slightly due to random seeds or GPU differences.



Notes

Sportmonks API: The head-to-head stats in new_data_with_head_to_head_stats.csv were precomputed to avoid API dependency. To re-scrape, ensure a valid API token and internet connection. The notebook includes memoization (lru_cache) to optimize API calls.
Team ID Mapping: Team names were mapped to Sportmonks IDs using all_england_teams.json (not included but referenced in the code). Manual mappings (e.g., “Bournemouth” to “AFC Bournemouth”) are handled in the notebook.
Missing Files: The notebook references all_england_teams.json and team_name_to_id.json for team ID mappings. If needed, regenerate these by running the team ID mapping sections or contact the author for copies.
Performance: GNN accuracy is estimated at ~70% based on training logs. Replace with your exact value if available.
Google Colab: For GPU support, use Colab with the provided datasets uploaded to your Google Drive or Colab session.

Troubleshooting

Module Not Found: Ensure all dependencies are installed. Check PyTorch Geometric compatibility with your PyTorch version.
API Errors: If Sportmonks API calls fail, use new_data_with_head_to_head_stats.csv to proceed.
Memory Issues: Reduce batch sizes in TCN/GNN training or use a system with more RAM/GPU memory.
Date Parsing Errors: The notebook handles date formats (e.g., “1st August 2022”). If errors occur, verify Premier_League.csv date formats.


Data sources: Football-Data.co.uk, Understat, Kaggle, Sportmonks.
Libraries: LightGBM, PyTorch, PyTorch Geometric, pandas, scikit-learn, requests, matplotlib, seaborn.

